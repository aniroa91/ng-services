@(day: String, labels: Array[(String, model.TotalInfo)], response: model.ReportResponse,totalQuery: Int)
@import play.api.libs.json.Json
@import services.domain.CommonService.getOthers

<script type="text/javascript">
        $(document).ready(function () {

            $(function () {
                $('[data-toggle="tooltip"]').tooltip({trigger: 'manual'}).tooltip('show');
            });

            $(".progress-bar").each(function(){
                each_bar_width = $(this).attr('aria-valuenow');
                $(this).width(each_bar_width + '%');
            });

            // auto count number
            $('.counter').counterUp({
                delay: 10,
                time: 1000
            });

            // chart bar top 5 domain
            Highcharts.chart('top5Main', {
                chart: {
                    type: 'bar',
                    height: '290px'
                },
                title: {
                    text: ""
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            enabled: true
                        }
                    }
                },
                xAxis: {
                    categories: @Html(Json.stringify(Json.toJson(response.seconds.take(5).map(x => x.name))))
                },

                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C'
                ],

                yAxis: {
                    title: {
                        text: ""
                    }
                },
                series: [
                    {
                        name: "Queries",
                        data: @Html(Json.stringify(Json.toJson(response.seconds.take(5).map(x => x.queries))))
                    }]
            });

            // chart bar
            Highcharts.chart('top5Malware', {
                chart: {
                    type: 'bar',
                    height: '290px'
                },
                title: {
                    text: ""
                },
                plotOptions: {
                    bar: {
                        dataLabels: {
                            enabled: true
                        }
                    }
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C'
                ],
                xAxis: {
                    categories: @Html(Json.stringify(Json.toJson(response.malwares.take(5).map(x => x.malware))))
                },

                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true
                        },
                        showInLegend: true
                    }
                },

                yAxis: {
                    title: {
                        text: ""
                    }
                },
                series: [
                    {
                        name: "Queries",
                        data: @Html(Json.stringify(Json.toJson(response.malwares.take(5).map(x => x.queries))))
                    }]
            });

            var black = 0
            var white = 0
            var unknow = 0
            @for(row <- labels){
              label = "@row._1"
              if(label == "black")
                  black = @row._2.queries
              else if(label == "white")
                  white = @row._2.queries
              else
                  unknow = @row._2.queries
            }
            // Build the chart query
            Highcharts.chart('echart_pie1', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },
                title: {
                    text: ''
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: 'Percent',
                    colorByPoint: true,
                    data: [ {
                        name: 'White',
                        y: white,
                        sliced: true,
                        selected: true
                    }, {
                        name: 'Black',
                        y: black
                    },{
                        name: 'Unknow',
                        y: unknow
                    }]
                }]
            });
            @for(row <- labels){
            label = "@row._1"
            if(label == "black")
                black = @row._2.clients
            else if(label == "white")
                white = @row._2.clients
            else
                unknow = @row._2.clients
                        }
            // Build the chart client
            Highcharts.chart('echart_pie2', {
                chart: {
                    plotBackgroundColor: null,
                    plotBorderWidth: null,
                    plotShadow: false,
                    type: 'pie'
                },
                title: {
                    text: ''
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: 'Percent',
                    colorByPoint: true,
                    data: [ {
                        name: 'White',
                        y: white,
                        sliced: true,
                        selected: true
                    }, {
                        name: 'Black',
                        y: black
                    }, {
                        name: 'Unknow',
                        y: unknow
                    }]
                }]
            });
            @for(row <- labels){
            label = "@row._1"
            if(label == "black")
                black = @row._2.seconds
            else if(label == "white")
                white = @row._2.seconds
            else
                unknow = @row._2.seconds
                        }
            // Build the chart second domain
            Highcharts.chart('echart_pie3', {
                chart: {
                    type: 'pie'
                },
                title: {
                    text: ''
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: 'Percent',
                    colorByPoint: true,
                    data: [ {
                        name: 'White',
                        y: white,
                        sliced: true,
                        selected: true
                    }, {
                        name: 'Black',
                        y: black
                    },{
                        name: 'Unknow',
                        y: unknow
                    }]
                }]
            });

            //var orgName = @@Html(Json.stringify(Json.toJson(response.org.map(x => x.org))));
            //var orgValue = @@Html(Json.stringify(Json.toJson(response.org.map(x => x.query))));
            var org = @Html(Json.stringify(Json.toJson(("others" -> getOthers(response.org.slice(0,5), response.current.queries)) +: response.org.slice(0,5))));
            // Build the chart organization
            Highcharts.chart('pie-chartOrg', {
                chart: {
                    type: 'pie'
                },
                title: {
                    text: ''
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        colors: [
                            '#3498DB',
                            '#1ABB9C',
                            '#9B59B6',
                            '#9CC2CB',
                            '#E74C3C',
                            '#73879C'
                        ],
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: false
                        },
                        showInLegend: false
                    }
                },
                series: [{
                    innerSize: '40%',
                    name: 'Percent',
                    colorByPoint: true,
                    data: org
                    /*data: [ {
                        name: 'IOS',
                        y: 30
                    }, {
                        name: 'Android',
                        y: 10
                    },{
                        name: 'Blackberry',
                        y: 20
                    },{
                        name: 'Symbian',
                        y: 15
                    },{
                        name: 'Other',
                        y: 30
                    }]*/
                }]
            });
            // Build the chart line

            var hourly = @Html(Json.stringify(Json.toJson(response.hourly.map(x => x.hour))));
            var queries = @Html(Json.stringify(Json.toJson(response.hourly.map(x => x.queries))));
            var clients = @Html(Json.stringify(Json.toJson(response.hourly.map(x => x.clients))));

            Highcharts.chart('chart-line', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: 'Number Of Client By Hour'
                },
                subtitle: {
                    text: 'Source: Dns Log'
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C'
                ],
                xAxis: {
                    categories: hourly
                },
                yAxis: {
                    title: {
                        text: 'Query & Client'
                    },
                    labels: {
                        formatter: function () {
                            return (this.value / 1000) + 'k';
                        }
                    }
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: [
                /*
                {
                    type: 'column',
                    name: 'Query',
                    marker: {
                        symbol: 'square'
                    },
                    data: queries
                    //data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, {
                    //    y: 26.5,
                        //marker: {
                        //    symbol: 'url(https://www.highcharts.com/samples/graphics/sun.png)'
                        //}
                    //}, 23.3, 18.3, 13.9, 9.6]

                }, */{
                    type: 'spline',
                    name: 'Client',
                    marker: {
                        symbol: 'diamond'
                    },
                    data: clients
                    //data: [{
                    //    y: 3.9,
                    //    marker: {
                    //        symbol: 'url(https://www.highcharts.com/samples/graphics/snow.png)'
                    //    }
                    //}, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
                }]
            });

            // Build the chart geo

            var country = @Html(Json.stringify(Json.toJson(response.country.slice(0,5))));
            function lower(obj) {
                for (var prop in obj) {
                    if (typeof obj[prop] === 'string') {
                        obj[prop] = obj[prop].toLowerCase();
                    }
                    if (typeof obj[prop] === 'object') {
                        lower(obj[prop]);
                    }
                }
                return obj;
            }
            Highcharts.mapChart('wdmap', {
                chart: {
                    map: 'custom/world'
                },

                title: {
                    text: ''
                },

                mapNavigation: {
                    enabled: true,
                    buttonOptions: {
                        verticalAlign: 'top'
                    }
                },
                legend:false,
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C'
                ],
                series: [{
                    data: lower(country),
                    name: 'Random data',
                    states: {
                        hover: {
                            color: '#BADA55'
                        }
                    },
                    dataLabels: {

                        enabled: true,

                        color: '#FFFFFF',

                        format: '{point.code}'

                    },

                    name: 'Visitors location',

                    tooltip: {

                        pointFormat:  '{point.name}: {point.value}'

                    }
                }]
            });
        });
</script>
