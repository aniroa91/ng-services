@(response: model.user.ProfileResponse, contract: String, idPayTv: String)
@import play.api.libs.json.Json
@import services.domain.CommonService.formatNumber
@import services.domain.CommonService.formatNumHour

<script type="text/javascript">
        $(document).ready(function () {
            $("#tbSegPaytv").find('tr:eq(1)').addClass('hight-light');
            // auto count number
            $('.counter').counterUp({
                delay: 10,
                time: 1000
            });
            // autocomplete
            var listContracts = [
                "HUFD08955","BDFD02717","DAD048115","DAFD10840","TNFD01957","SLFD00293","LSFD03412","HNH236126","BDD005873","NTFD08246","DNFD21880","DNFD21875","NTFD09091","VLFD01954","SGH209147","HMFD01095","NTFD08147","QTFD00164","LAFD02695","VPFD02046","NTFD08490","BTFD05630","CTD025308","HPFD14341","SGH210510","CTD025308","HNH212346","NBFD02615","SGH210160","QNFD09571","HDFD05936","LSFD03397","HYFD03518","SGH212667","SGH212667","NTFD08534","HTFD00614","LDFD03872","TQFD02416","TNFD01968","HPFD14355","SGH212894","QNFD07990","AGFD05107","SGH212055","SGH212679","TNFD01906","SGH212907","AGFD05055","SGH212654","BDFD06200","BDFD06200","DLFD03323","SGH212169","HNH048249","PTFD01356","DAFD11035","HUFD01005","HPD003862","HPFD14159","HMFD01099","SGH212435","LDFD03853","DAFD11055","NDFD02190","BDD006186","BTFD05475","PTFD01342","BTFD05475","HTFD00623","NDFD01953","HPFD14176","BNFD08634","DNFD37665","BPFD02810","SGH095989","SGH247446","GLFD03947","SGH212852","BDFD06170","HTFD00624","TNFD01952","AGFD04570","QNFD08800","HNH212288","SGH213072","NDFD01928","SGH211382","TNFD01905","NDFD01940","NDFD01929","LSFD03442","SGH211994","HYFD03539","HUFD08758","NDFD02196","GLFD02554","SGH212837","SGH212100","NDFD01951","LSFD03441","VTD026363","AGD018793","NTFD09035","NDFD02205","SGH212403","BDFD06219","SGH213065","SGH212882","QAFD01870","SGH079714","HYFD03475","LSFD03399","HPFD14403","HYFD03475","LDD019743","HPFD14365","DNFD21878","DAD020539","LDD019743","SGH211634","HNH002849","LDFD03897","DNFD21878","HNH212638","GLFD02567","LDFD03882","BDFD05859","SGH212143","BDFD06244","SGH212143","NAFD01028","HNH355436","HNH355151","DND007172","BDD004626","BDD000027","DND003213","BDD006543","SGH018289","BDD005828","CTFD12224","BDD003339","HDD030000","SGD228370","QNFD20988","BDD006410","BDD001071","SGH232074","HDD000066","STD003161","DAFD14440","BGFD10224","SGH223919","HDD007807","HNH253179","DND075401","BGFD08935","HDD023109","DND035949","DNFD37040","HNH251578","DNFD11355","HND440892","SGH264080","SGH293974","DND064819","DNFD12802","HDFD02824","SGH081959","NTFD04756","HDFD03490","SGH081577","DAD054747","HPFD08783","QNFD08897","BIFD02357","VTFD06989","CTFD07354","LAD004040","SGH083516","DNFD17454","QNFD06927","DNFD05895","SGH082650","SGH082847","DND049657","DNFD17454","SGH082121","HPFD08552","SGH081934","SGH082131","QND036965","DAFD05955","DAFD05955","BDD064055","HPFD08851","HDFD03555","DLFD02209","SGH084411","QND036965","HPFD08766","HPFD08852","BDD055418","HDFD03566","HDFD03563","SGH082123","HDFD05560","HDFD03562","QNFD03156","HPFD08781","BDD006141","SGH096025","HDD027833","CTFD07441","SGH082141","QTFD05313","SGH083260","TIFD03157","HDFD03570","DAFD23977","BDD005859","DTFD04226","BDD005004","HNH354433","SGH211993","HPFD14413","HPFD14296","HYFD06107","HPFD14242","SGD241237","SGH080337","NBFD04938","HPFD29978","HNH078989","HNH078989","SGH018225","CTFD07406","VTFD08149","SGH200832","NTFD04752","SGH251848","THFD00735","NTFD16250","SGH081567","DLFD02213","DAD017635","HPFD29847","DNFD16408","SGH083132","HBFD02145","HPFD08597","SGH249375","DLFD02212","NTFD04741","BDFD46717","HPFD29862","DAFD21305","QND056190","NTFD04744","SGH083958","HPFD29921","HPFD17796","BDFD70124","NTFD04771","SGH084438","CMFD01712","HYFD06215","SGD523452","HPFD29688","SGH094006","BGFD08883","QNFD06943","HPD020218","LDFD02663","DND084510","DAFD14609","SGH083948","SGD711642","SGH083274","NTD009689","HPFD08778","HPFD29688","HNH354747","HDFD05542","DNFD18945","HPFD29657","HDFD05542","HPD062608","HYFD06217","SGH083953","SGD797354","NTFD04745","HPFD29920","DND084514","HDFD03551","HNH355969","SGH096041","DND057621","LDFD02665","DAD054761","DAD002137","DNFD18905","HPFD08564","TGFD01944","SGH003263","HYFD06188","DAD005828","HNH354632","SGH082855","SGH081415","SGH083968","HNH355728","DND004461","STFD00740","SGH212743","HYFD03514","TNFD01949","BDD006179","VTD000404","SGH211685","SGH211664","NDFD02191","SGH209998","BDD003074","SGH210429","BGFD02555","HPFD09346","NTFD09036","STFD01260","NTD021714","HPFD14367","BGFD02585","HPFD14493","NTFD08504","HMFD01096","NTFD09043","HPD003468","DND003924","NTFD09016","NTFD09131","HDD000537","DND004643","SGH213362","QNFD07977","SGH211757","NTFD08511","SGD084312","LDFD03771","NTFD09028","VTFD09914","VPFD02209","SGH212158","HYFD03475","SGH212067","SGH213192","SGH213128","NTFD08100","SGH212158","SGH212119","BDFD51645","DAFD11145","QNFD09572","SGH212364","BTFD05675","SGH212019","BDFD06207","SGH211150","SGH003596","SGH213139","BDFD52806","SGH213257","BDFD06274","SGH211452","BGFD07816","SGH213298","VTD042108","SGH211558","SGH213498","QNFD09538","QAFD01821","LAFD02855","DAFD11139","QNFD09538","BTFD05585","LCFD03084","VTFD07347","QIFD01300","SGH054448","SGH096889","SGD238938","HDFD10365","DNFD43810","BDD006756","SGH313426","DAD006070","DAD040745","SGH092905","HPFD20039","HNH248717","SGD193994"
            ];

            $(".autocomplete").autocomplete({
                source: listContracts,
                select: function(event, ui) {
                    $("#ct").val(ui.item.value);
                    $("#ctSearch").submit(); }
            });
            /* START CHART FOR PAYTV*/
            /* START CLICK PAYTV ID */
            @if(idPayTv != null) {
            @for(p <- response.paytv.segments) {
              $("#@p._1").click(function(e) {
                  $("#tbSegPaytv").find('.hight-light').removeClass('hight-light');
                 $(this).parent().parent().addClass('hight-light');
                // chart hourly vector
                var hourly = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.hourly.map(x => x.key))));
                var values = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.hourly.map(x => formatNumHour(x.value)))));
                var hourInMonth = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.hourlyInMonths.map(x => x.value))));
                  Highcharts.chart('line-hourVector', {
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: ''
                    },
                    subtitle: {
                        text: ''
                    },
                    plotOptions: {
                        column: {
                            colorByPoint: true
                        }
                    },
                    colors: [
                        '#1ABB9C','#9B59B6'
                    ],
                    xAxis: {
                        categories: hourly
                    },
                    yAxis: [{ // Primary yAxis
                        title: {
                            text: 'Duration (hours)',
                            style: {
                                color: "#1ABB9C"
                            }
                        }
                      }/*, { // Secondary yAxis
                        title: {
                            text: 'Values',
                            style: {
                                color: "#9B59B6"
                            }
                        },
                        opposite: true
                     }*/],
                    tooltip: {
                        crosshairs: true,
                        shared: true
                    },
                    plotOptions: {
                        spline: {
                            marker: {
                                radius: 4,
                                lineColor: '#666666',
                                lineWidth: 1
                            }
                        }
                    },
                    series: [{
                        type: 'spline',
                        name: 'Hourly',
                        data: values
                    }/*,{
                        type: 'spline',
                        name: 'Hourly in month',
                        data: hourInMonth,
                        yAxis:1
                    }*/]
                });
                  // Build the chart pie app vector
                  var appVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.app.map(x => x.key -> x.value))));
                  Highcharts.chart('pie-appVector', {
                      chart: {
                          type: 'pie'
                      },
                      title: {
                          text: ''
                      },
                      tooltip: {
                          pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                      },
                      plotOptions: {
                          pie: {
                              colors: [
                                  '#3498DB',
                                  '#1ABB9C',
                                  '#9B59B6',
                                  '#9CC2CB',
                                  '#E74C3C',
                                  '#73879C'
                              ],
                              allowPointSelect: true,
                              cursor: 'pointer',
                              dataLabels: {
                                  enabled: true
                              },
                              showInLegend: true
                          }
                      },
                      series: [{
                          name: 'Percent',
                          innerSize: '40%',
                          colorByPoint: true,
                          data: appVectors
                      }]
                  });
                  // Build the chart line daily vector
                  var daily = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.dayOfWeek.map(x => x.key))));
                  values = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.dayOfWeek.map(x => formatNumHour(x.value)))));
                  Highcharts.chart('col-dayVector', {
                      chart: {
                          type: 'column'
                      },
                      title: {
                          text: ''
                      },
                      xAxis: {
                          categories: daily
                      },
                      yAxis: {
                          min: 0,
                          title: {
                              text: 'Average(hours)'
                          }
                      },
                      tooltip: {
                          headerFormat: '<span style="font-size:10px">Day of week: {point.key}</span><table>',
                          pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                          '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                          footerFormat: '</table>',
                          shared: true,
                          useHTML: true
                      },
                      plotOptions: {
                          column: {
                              pointPadding: 0.2,
                              borderWidth: 0,
                          }
                      },
                      colors: [
                          '#1ABB9C'
                      ],
                      series: [{
                          name: 'Duration day of week',
                          data: values

                      }]
                  });
                  // Build the chart pie iptv vector
                  var iptvVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.iptv.filter(x => x.value > 0).map(x => x.key -> x.value))));
                  Highcharts.chart('pie-iptvVector', {
                      chart: {
                          type: 'pie'
                      },
                      title: {
                          text: ''
                      },
                      tooltip: {
                          pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                      },
                      plotOptions: {
                          pie: {
                             /* colors: [
                                  '#9B59B6',
                                  '#1ABB9C',
                                  '#3498DB',
                                  '#9CC2CB',
                                  '#E74C3C',
                                  '#73879C'
                              ],*/
                              allowPointSelect: true,
                              cursor: 'pointer',
                              dataLabels: {
                                  enabled: true
                              },
                              showInLegend: true
                          }
                      },
                      series: [{
                          name: 'Percent',
                          innerSize: '40%',
                          colorByPoint: true,
                          data: iptvVectors
                      }]
                  });
                  // Build the chart pie vod vector
                  @if(response.paytv.vectors.get(p._1).get.vod != null){
                      var vodVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.vod.filter(x => x.value > 0).map(x => x.key -> x.value))));
                      Highcharts.chart('pie-vodVector', {
                          chart: {
                              type: 'pie'
                          },
                          title: {
                              text: ''
                          },
                          tooltip: {
                              pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                          },
                          plotOptions: {
                              pie: {
                                  /*colors: [
                                      '#9B59B6',
                                      '#1ABB9C',
                                      '#3498DB',
                                      '#9CC2CB',
                                      '#E74C3C',
                                      '#73879C'
                                  ],*/
                                  allowPointSelect: true,
                                  cursor: 'pointer',
                                  dataLabels: {
                                      enabled: true
                                  },
                                  showInLegend: true
                              }
                          },
                          series: [{
                              name: 'Percent',
                              innerSize: '40%',
                              colorByPoint: true,
                              data: vodVectors
                          }]
                      });
                  }
                  // Build the chart pie vod child vector
                  @if(response.paytv.vectors.get(p._1).get.vodthieunhi != null){
                      var vodChildVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.vodthieunhi.filter(x => x.value > 0).map(x => x.key -> x.value))));
                      Highcharts.chart('pie-vodChildVector', {
                          chart: {
                              type: 'pie'
                          },
                          title: {
                              text: ''
                          },
                          tooltip: {
                              pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                          },
                          plotOptions: {
                              pie: {
                                  /*colors: [
                                      '#9B59B6',
                                      '#1ABB9C',
                                      '#3498DB',
                                      '#9CC2CB',
                                      '#E74C3C',
                                      '#73879C'
                                  ],*/
                                  allowPointSelect: true,
                                  cursor: 'pointer',
                                  dataLabels: {
                                      enabled: true
                                  },
                                  showInLegend: true
                              }
                          },
                          series: [{
                              name: 'Percent',
                              innerSize: '40%',
                              colorByPoint: true,
                              data: vodChildVectors
                          }]
                      });
                  }
                  // Build the chart pie vod child vector
                  @if(response.paytv.vectors.get(p._1).get.vodgiaitri != null){
                      var vodRelaxVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.vodgiaitri.filter(x => x.value > 0).map(x => x.key -> x.value))));
                      Highcharts.chart('pie-vodRelaxVector', {
                          chart: {
                              type: 'pie'
                          },
                          title: {
                              text: ''
                          },
                          tooltip: {
                              pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                          },
                          plotOptions: {
                              pie: {
                                  /*colors: [
                                      '#9B59B6',
                                      '#1ABB9C',
                                      '#3498DB',
                                      '#9CC2CB',
                                      '#E74C3C',
                                      '#73879C'
                                  ],*/
                                  allowPointSelect: true,
                                  cursor: 'pointer',
                                  dataLabels: {
                                      enabled: true
                                  },
                                  showInLegend: true
                              }
                          },
                          series: [{
                              name: 'Percent',
                              innerSize: '40%',
                              colorByPoint: true,
                              data: vodRelaxVectors
                          }]
                      });
                  }
                  // Build the chart line app-daily vector
                  var appHour2 = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.appHourly2)));
            Highcharts.chart('line-appHourVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#9B59B6',
                    '#1ABB9C',
                    '#000066',
                    '#3498DB',
                    '#9CC2CB',
                    '#E74C3C',
                    '#73879C',
                    '#ff9600'
                ],
                xAxis: {
                    categories: ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","21","22","23"],
                    title: {
                        text: ''
                    },
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: /*[
                    {
                        type: 'spline',
                        name: 'IPTV',
                        marker: {
                            symbol: 'square'
                        },
                        data: iptvHourly

                    },{
                        type: 'spline',
                        name: 'VOD',
                        marker: {
                            symbol: 'diamond'
                        },
                        data: vodHourly
                    }]*/
                getJsonAppVector(appHour2)
            });

            // Build the chart line app-daily vector
                  var appDaily2 = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.appDayOfWeek2)));
                  Highcharts.chart('line-appDayVector', {
                      chart: {
                          type: 'column'
                      },
                      title: {
                          text: ''
                      },
                      subtitle: {
                          text: ''
                      },
                      plotOptions: {
                          column: {
                              colorByPoint: true
                          }
                      },
                      colors: [
                          '#9B59B6',
                          '#1ABB9C',
                          '#000066',
                          '#3498DB',
                          '#9CC2CB',
                          '#E74C3C',
                          '#73879C',
                          '#ff9600'
                      ],
                      xAxis: {
                          categories: ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday']
                      },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series:/* [
                    {
                        type: 'spline',
                        name: 'IPTV',
                        marker: {
                            symbol: 'square'
                        },
                        data: iptvDayOfWeek

                    },{
                        type: 'spline',
                        name: 'VOD',
                        marker: {
                            symbol: 'diamond'
                        },
                        data: vodDayOfWeek
                    }]*/
                      getJsonAppVector(appDaily2)
            });


                  // Build the chart line day of month vector
                  daily = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.daily.map(x => x._1))));
                  values = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(p._1).get.daily.map(x => formatNumHour(x._2)))));
                  Highcharts.chart('col-dayofMonth', {
                      chart: {
                          type: 'column'
                      },
                      title: {
                          text: ''
                      },
                      xAxis: {
                          categories: daily,
                          crosshair: true
                      },
                      yAxis: {
                          min: 0,
                          title: {
                              text: 'Average duration(hours)'
                          }
                      },
                      tooltip: {
                          headerFormat: '<span style="font-size:10px">Day of week: {point.key}</span><table>',
                          pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                          '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                          footerFormat: '</table>',
                          shared: true,
                          useHTML: true
                      },
                      plotOptions: {
                          column: {
                              pointPadding: 0.2,
                              borderWidth: 0,
                          }
                      },
                      colors: [
                          '#1ABB9C'
                      ],
                      series: [{
                          type: 'spline',
                          name: 'Duration day of month',
                          data: values
                      }]
                  });

              });
            }
           /* END CLICK PAYTV ID */

            /* START CHART FOR PAYTV*/
            // Build the chart pie app vector
            var appVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.app.map(x => x.key -> x.value))));
            Highcharts.chart('pie-appVector', {
                chart: {
                    type: 'pie'
                },
                title: {
                    text: ''
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        colors: [
                            '#9B59B6',
                            '#1ABB9C',
                            '#3498DB',
                            '#9CC2CB',
                            '#E74C3C',
                            '#73879C'
                        ],
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: 'Percent',
                    innerSize: '40%',
                    colorByPoint: true,
                    data: appVectors
                }]
            });


            // Build the chart line hourly vector
            var hourly = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.hourly.map(x => x.key))));
            var values = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.hourly.map(x => formatNumHour(x.value)))));
            var hourInmonth = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.hourlyInMonths.map(x => x.value))));
            Highcharts.chart('line-hourVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C','#9B59B6'
                ],
                xAxis: {
                    categories: hourly
                },
                yAxis: [{ // Primary yAxis
                    title: {
                        text: 'Duration (hours)',
                        style: {
                            color: "#1ABB9C"
                        }
                    }
                }/*, { // Secondary yAxis
                    title: {
                        text: 'Values',
                        style: {
                            color: "#9B59B6"
                        }
                    },
                    opposite: true
                }*/],
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: [{
                    type: 'spline',
                    name: 'Hourly',
                    data: values
                }/*,{
                    type: 'spline',
                    name: 'Hourly in month',
                    data: hourInmonth,
                    yAxis: 1
                }*/]
            });

            // Build the chart line app-daily vector

            var appHour2 = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.appHourly2)));
            Highcharts.chart('line-appHourVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#9B59B6',
                    '#1ABB9C',
                    '#000066',
                    '#3498DB',
                    '#9CC2CB',
                    '#E74C3C',
                    '#73879C',
                    '#ff9600'
                ],
                xAxis: {
                    categories: ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","21","22","23"]
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: getJsonAppVector(appHour2)
            });

            // Build the chart line app-daily vector
            var appDaily2 = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.appDayOfWeek2)));
            Highcharts.chart('line-appDayVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#9B59B6',
                    '#1ABB9C',
                    '#000066',
                    '#3498DB',
                    '#9CC2CB',
                    '#E74C3C',
                    '#73879C',
                    '#ff9600'
                ],
                xAxis: {
                    categories: ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday']
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: /*[
                    {
                        type: 'spline',
                        name: 'IPTV',
                        marker: {
                            symbol: 'square'
                        },
                        data: iptvDayOfWeek

                    },{
                        type: 'spline',
                        name: 'VOD',
                        marker: {
                            symbol: 'diamond'
                        },
                        data: vodDayOfWeek
                    }]*/
                getJsonAppVector(appDaily2)
            });

            // Build the chart line iptv vector
            var iptvVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.iptv.filter(x => x.value > 0).map(x => x.key -> x.value))));
            Highcharts.chart('pie-iptvVector', {
                chart: {
                    type: 'pie'
                },
                title: {
                    text: ''
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        /*colors: [
                            '#9B59B6',
                            '#1ABB9C',
                            '#3498DB',
                            '#9CC2CB',
                            '#E74C3C',
                            '#73879C'
                        ],*/
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: 'Percent',
                    innerSize: '40%',
                    colorByPoint: true,
                    data: iptvVectors
                }]
            });
            // Build the chart pie vod vector
            @if(response.paytv.vectors.get(idPayTv).get.vod != null){
                var vodVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.vod.filter(x => x.value > 0).map(x => x.key -> x.value))));
                Highcharts.chart('pie-vodVector', {
                    chart: {
                        type: 'pie'
                    },
                    title: {
                        text: ''
                    },
                    tooltip: {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    },
                    plotOptions: {
                        pie: {
                            /*colors: [
                                '#9B59B6',
                                '#1ABB9C',
                                '#3498DB',
                                '#9CC2CB',
                                '#E74C3C',
                                '#73879C'
                            ],*/
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true
                            },
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Percent',
                        innerSize: '40%',
                        colorByPoint: true,
                        data: vodVectors
                    }]
                });
            }
            // Build the chart pie vod child vector
            @if(response.paytv.vectors.get(idPayTv).get.vodthieunhi != null){
                var vodChildVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.vodthieunhi.filter(x => x.value > 0).map(x => x.key -> x.value))));
                Highcharts.chart('pie-vodChildVector', {
                    chart: {
                        type: 'pie'
                    },
                    title: {
                        text: ''
                    },
                    tooltip: {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    },
                    plotOptions: {
                        pie: {
                            /*colors: [
                                '#9B59B6',
                                '#1ABB9C',
                                '#3498DB',
                                '#9CC2CB',
                                '#E74C3C',
                                '#73879C'
                            ],*/
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true
                            },
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Percent',
                        innerSize: '40%',
                        colorByPoint: true,
                        data: vodChildVectors
                    }]
                });
            }
            // Build the chart pie vod child vector
            @if(response.paytv.vectors.get(idPayTv).get.vodgiaitri != null){
                var vodRelaxVectors = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.vodgiaitri.filter(x => x.value > 0).map(x => x.key -> x.value))));
                Highcharts.chart('pie-vodRelaxVector', {
                    chart: {
                        type: 'pie'
                    },
                    title: {
                        text: ''
                    },
                    tooltip: {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    },
                    plotOptions: {
                        pie: {
                            /*colors: [
                                '#9B59B6',
                                '#1ABB9C',
                                '#3498DB',
                                '#9CC2CB',
                                '#E74C3C',
                                '#73879C'
                            ],*/
                            allowPointSelect: true,
                            cursor: 'pointer',
                            dataLabels: {
                                enabled: true
                            },
                            showInLegend: true
                        }
                    },
                    series: [{
                        name: 'Percent',
                        innerSize: '40%',
                        colorByPoint: true,
                        data: vodRelaxVectors
                    }]
                });
            }

            // Build the chart line daily vector
            var daily = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.dayOfWeek.map(x => x.key))));
                values = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.dayOfWeek.map(x => formatNumHour(x.value)))));
            Highcharts.chart('col-dayVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                xAxis: {
                    categories: daily,
                    crosshair: true
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'Average(hours)'
                    }
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">Day of week: {point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                    }
                },
                colors: [
                    '#1ABB9C'
                ],
                series: [{
                    name: 'Duration day of week',
                    data: values

                }]
            });

            // Build the chart line day of month vector
            daily = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.daily.map(x => x._1))));
            values = @Html(Json.stringify(Json.toJson(response.paytv.vectors.get(idPayTv).get.daily.map(x => formatNumHour(x._2)))));
            Highcharts.chart('col-dayofMonth', {
                chart: {
                    type: 'spline'
                },
                title: {
                    text: ''
                },
                xAxis: {
                    categories: daily,
                    crosshair: true
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'Average Duration(hours)'
                    }
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">Day of week: {point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        pointPadding: 0.2,
                        borderWidth: 0,
                    }
                },
                colors: [
                    '#1ABB9C'
                ],
                series: [{
                    name: 'Duration day of month',
                    data: values
                }]
            });
            }
            /* END CHART FOR PAYTV*/

            /* START CHART FOR INTERNET*/

            // Build the chart line hourly vector
            hourly = @Html(Json.stringify(Json.toJson(response.internet.duration.hourly.map(x => x._1))));
            values = @Html(Json.stringify(Json.toJson(response.internet.duration.hourly.map(x => formatNumHour(x._2)))));
            Highcharts.chart('int-durHourVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C'
                ],
                xAxis: {
                    categories: hourly

                }, yAxis: {
                  title: {
                    text: "Time (hours)"
                  }
                  
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: [{
                    type: 'spline',
                    name: 'Hourly',
                    marker: {
                        symbol: 'diamond'
                    },
                    data: values

                }]
            });

            // Build the chart line hourly vector
            Highcharts.chart('int-line-hourVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C','#9B59B6'
                ],
                xAxis: {
                    categories: ["7h-13h","13h-19h","19h-1h","1h-7h"]

                },
                yAxis: {
                  title: {
                    text: "Size (GB)"
                  }
                  
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: [
                {
                    type: 'spline',
                    name: 'Download',
                    // change down and up 11/10
                    data: @Html(Json.stringify(Json.toJson(response.internet.downUp.upQuad.map(x => BigDecimal(x._2).setScale(3, BigDecimal.RoundingMode.HALF_UP).toDouble))))
                },{
                type: 'spline',
                        name: 'Upload',
                        data: @Html(Json.stringify(Json.toJson(response.internet.downUp.downQuad.map(x => BigDecimal(x._2).setScale(3, BigDecimal.RoundingMode.HALF_UP).toDouble))))
                }]
            });
            // Build the chart line hourly vector
            var valueDown = @Html(Json.stringify(Json.toJson(response.internet.downUp.downDayOfWeek.map(x => x._2).toList.transpose.map(_.sum))));
            var valueUp = @Html(Json.stringify(Json.toJson(response.internet.downUp.upDayOfWeek.map(x => x._2).toList.transpose.map(_.sum))));
            Highcharts.chart('int-col-dayVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#1ABB9C','#9B59B6'
                ],
                xAxis: {
                    categories: ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday']
                },
                yAxis: {
                  title: {
                    text: "Size (GB)"
                  }
                  
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: [{
                    type: 'spline',
                    name: 'Download',
                    data: valueDown
                   },
                    {
                        type: 'spline',
                        name: 'Upload',
                        data: valueUp
                    }]
            });
           // Build the chart line hourly vector
            values = @Html(Json.stringify(Json.toJson(response.internet.duration.dayOfWeek.map(x => x._2).toList.transpose.map(_.sum).map(x => formatNumHour(x)))));
            Highcharts.chart('int-pie-durDayVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                 yAxis: {
                  title: {
                    text: "Time (hours)"
                  }
                  
                },
                colors: [
                    '#9B59B6',
                    '#1ABB9C',
                    '#3498DB',
                    '#9CC2CB',
                ],
                xAxis: {
                    categories: ['Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday']

                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: [{
                    type: 'spline',
                    name: 'Duration',
                    marker: {
                        symbol: 'diamond'
                    },
                    data: values
                }]
                //getJsonAppVector(values)
            });
            // Build the chart line day of month vector
            Highcharts.chart('int-col-dayofMonth', {
                chart: {
                    zoomType: 'xy'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                xAxis: [{
                    categories: @Html(Json.stringify(Json.toJson(response.internet.downUp.downDaily.map(x => x._1)))),
                    crosshair: true,
                    title: {
                        text: 'Daily',
                    }
                }],
                yAxis: [{ // Primary yAxis
                    labels: {
                        format: '{value} MB',
                        style: {
                            color: "#1ABB9C"
                        }
                    },
                    title: {
                        text: 'Size (MB)',
                        style: {
                            color: "#1ABB9C"
                        }
                    }
                }, { // Secondary yAxis
                    title: {
                        text: 'Duration (hours)',
                        style: {
                            color: "#9B59B6  MB"
                        }
                    },
                    labels: {
                        format: '{value}',
                        style: {
                            color: "#9B59B6"
                        }
                    },
                    opposite: true
                }],
                tooltip: {
                    shared: true
                },

                series: [
                {
                    type: 'column',
                    name: 'Duration',
                    yAxis: 1,
                    data: @Html(Json.stringify(Json.toJson(response.internet.duration.daily.map(x => BigDecimal(x._2 / 3600).setScale(3, BigDecimal.RoundingMode.HALF_UP).toDouble))))
                }, {
                    name: 'Upload',
                    type: 'spline',
                    color: "#9B59B6",
                    data: @Html(Json.stringify(Json.toJson(response.internet.downUp.upDaily.map(x => BigDecimal(x._2 * 1024).setScale(3, BigDecimal.RoundingMode.HALF_UP).toDouble))))

                }, {
                    name: 'Download',
                    type: 'spline',
                    color: "#1ABB9C",
                    data: @Html(Json.stringify(Json.toJson(response.internet.downUp.downDaily.map(x => BigDecimal(x._2 * 1024).setScale(3, BigDecimal.RoundingMode.HALF_UP).toDouble))))
                }]
            });

            // chart line suy vector
            values = @Html(Json.stringify(Json.toJson(response.internet.suyhout.map(x => if (x._2.toBoolean) 1 else -1))))
            Highcharts.chart('line-suyVector', {
                chart: {
                    type: 'column',
                    events: {
                        load: function () {
                             $.each(this.series[0].data, function(i, point) {
                                if(point.y>0)
                                   point.graphic.attr({ fill: '#1ABB9C' });
                                else
                                    point.graphic.attr({ fill: '#FF0000' });
                            });
                        }
                    }
                },
                legend: {
                    enabled: false
                },
                title: {
                    text: ''
                },
                xAxis: {
                    categories: @Html(Json.stringify(Json.toJson(response.internet.suyhout.map(x => x._1))))
                },
                yAxis: {
                    min: -1,
                    title: {
                        text: 'Value'
                    }
                },
                tooltip: {
                    headerFormat: '<span style="font-size:10px">Date: {point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f}</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions:{
                    column:{
                        pointPadding: 0.2,
                        borderWidth: 0,
                        point: {
                            events:  {
                                mouseOut: function(){
                                    console.log('mouseout');
                                    var chart = $('#line-suyVector').highcharts();
                                    $.each(chart.series[0].data, function(i, point) {
                                        if(point.y>0)
                                            point.graphic.attr({ fill: '#1ABB9C' });
                                        else
                                            point.graphic.attr({ fill: '#FF0000' });
                                    });
                                },
                                mouseOver: function(){
                                    console.log('mouseover');
                                    var chart = $('#line-suyVector').highcharts();
                                    $.each(chart.series[0].data, function(i, point) {
                                        if(point.y>0)
                                            point.graphic.attr({ fill: '#1ABB9C' });
                                        else
                                            point.graphic.attr({ fill: '#FF0000' });
                                    });
                                },
                            },
                        },
                        states:{hover:{enabled:false}},
                    },
                },
                series: [{
                    name: 'Value',
                    data: values
                }]
            });
                // chart line error vector

            Highcharts.chart('line-errVector', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#3498DB','#fbc28d'
                ],
                xAxis: {
                    categories: @Html(Json.stringify(Json.toJson(response.internet.errorDisconnect.map(x => x._1))))
                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: [
                    {
                        type: 'spline',
                        name: 'Lofi',
                        marker: {
                            symbol: 'square'
                        },
                        data: @Html(Json.stringify(Json.toJson(response.internet.errorDisconnect.map(x => x._2))))

                    },{
                        type: 'spline',
                        name: 'Sf',
                        marker: {
                            symbol: 'diamond'
                        },
                        data: @Html(Json.stringify(Json.toJson(response.internet.errorModule.map(x => x._2))))
                    }]
            });
            // Build the chart pie device types
            var deviceTypes = @Html(Json.stringify(Json.toJson(response.internet.device.deviceTypes)))
            Highcharts.chart('pie-deviceType', {
                chart: {
                    type: 'pie'
                },
                title: {
                    text: ''
                },
                tooltip: {
                    pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                },
                plotOptions: {
                    pie: {
                        colors: [
                            '#1ABB9C',
                            '#9B59B6',
                            '#3498DB',
                            '#E74C3C',
                            '#9CC2CB',
                            '#73879C'
                        ],
                        allowPointSelect: true,
                        cursor: 'pointer',
                        dataLabels: {
                            enabled: true
                        },
                        showInLegend: true
                    }
                },
                series: [{
                    name: 'Percent',
                    innerSize: '40%',
                    colorByPoint: true,
                    data: deviceTypes
                }]
            });
            // Build the chart pie device types
            var venders = @Html(Json.stringify(Json.toJson(response.internet.device.venders)))
                    Highcharts.chart('pie-venderType', {
                        chart: {
                            type: 'pie'
                        },
                        title: {
                            text: ''
                        },
                        tooltip: {
                            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                        },
                        plotOptions: {
                            pie: {
                                /*colors: [
                                    '#1ABB9C',
                                    '#E74C3C',
                                    '#3498DB',
                                    '#9B59B6',
                                    '#9CC2CB',
                                    '#73879C'
                                ],*/
                                allowPointSelect: true,
                                cursor: 'pointer',
                                dataLabels: {
                                    enabled: true
                                },
                                showInLegend: true
                            }
                        },
                        series: [{
                            name: 'Percent',
                            innerSize: '40%',
                            colorByPoint: true,
                            data: venders
                        }]
                    });

            // Build the chart line device
           values =  @Html(Json.stringify(Json.toJson(response.internet.device.deviceChars.map(x => x._2))));
           var name = @Html(Json.stringify(Json.toJson(response.internet.device.deviceChars.map(x => x._1.split(",")(0)))));
            Highcharts.chart('line-device', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#9B59B6',
                    '#1ABB9C',
                    '#000066',
                    '#3498DB',
                    '#9CC2CB',
                    '#E74C3C',
                    '#73879C',
                    '#ff9600',
                    '#b6a278',
                    '#ffd6e1'
                ],
                width:'100%',
                xAxis: {
                    categories: ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","21","22","23","24","25","26","27","28","29"]
                },
                yAxis: {
                    title: {
                        text: ""
                    }

                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: /*[
                    {
                        type: 'spline',
                        name: 'W1',
                        data: [12,20,2,31]
                    },{
                        type: 'spline',
                        name: 'W2',
                        data: [42,10,22,61]
                    },
                    {
                        type: 'spline',
                        name: 'W3',
                        data: [4,50,22,41]
                    },{
                        type: 'spline',
                        name: 'W4',
                        data: [52,32,68,11]
                    }]*/
                        getJsonDeviceVector(values,name)
            });
            /* END CHART FOR INTERNET*/
        });

        function activeDevice(element){
            var mac = $(element).find("td:eq(0)").text();
            if($(element).hasClass('hight-light'))
              mac = null;
            $("#tbDevice").find('.hight-light').removeClass('hight-light');
            if(mac != null)
                $(element).addClass('hight-light');
            var values =  @Html(Json.stringify(Json.toJson(response.internet.device.deviceChars.map(x => x._2))));
            var name = @Html(Json.stringify(Json.toJson(response.internet.device.deviceChars.map(x => x._1.split(",")(0)))));
            Highcharts.chart('line-device', {
                chart: {
                    type: 'column'
                },
                title: {
                    text: ''
                },
                subtitle: {
                    text: ''
                },
                plotOptions: {
                    column: {
                        colorByPoint: true
                    }
                },
                colors: [
                    '#9B59B6',
                    '#1ABB9C',
                    '#000066',
                    '#3498DB',
                    '#9CC2CB',
                    '#E74C3C',
                    '#73879C',
                    '#ff9600',
                    '#b6a278',
                    '#ffd6e1'
                ],
                width:'100%',
                xAxis: {
                    categories: ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","21","22","23","24","25","26","27","28","29"]
                },
                yAxis: {
                    title: {
                        text: ""
                    }

                },
                tooltip: {
                    crosshairs: true,
                    shared: true
                },
                plotOptions: {
                    spline: {
                        marker: {
                            radius: 4,
                            lineColor: '#666666',
                            lineWidth: 1
                        }
                    }
                },
                series: getJsonDeviceVector(values,name,mac)
            });
        }

        function getJsonAppVector(appHour){
            var jsonArr = [];
            for (var i = 0; i < appHour.length; i++) {
                jsonArr.push({
                    type: "spline",
                    name: appHour[i][0],
                    data: convertHourly(appHour[i][1])
                });
            }
            return jsonArr
        }

        function getJsonDeviceVector(arrsData,name,mac){
            var jsonArr = [];
            for (var i = 0; i < arrsData.length; i++) {
                if(mac == null) {
                    jsonArr.push({
                        type: "spline",
                        name: name[i],
                        data: arrsData[i]
                    });
                }
                else if(mac == name[i]) {
                    jsonArr.push({
                        type: "spline",
                        name: mac,
                        data: arrsData[i]
                    });
                }
            }
            return jsonArr
        }

        function convertHourly(arr){
            for(var i=0; i< arr.length;i++){
                arr[i] = parseFloat((arr[i]/3600).toFixed(2));
            }
            return arr
        }
 </script>