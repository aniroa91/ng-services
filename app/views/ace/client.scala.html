@(form: Form[SearchData], response: model.ClientResponse, topClient: Array[(String, Int)], ip: String)(implicit messages: Messages)
@import services.domain.CommonService.getLinkTag
@import services.domain.CommonService.formatNumber
@import play.api.libs.json.Json

@top("..", "Client", 11)

<div class="page-header">
	<h1>
		Client Detail Page
		<!--
		<small>
			<i class="ace-icon fa fa-angle-double-right"></i>
		</small>
		-->
	</h1>
</div><!-- /.page-header -->

<div class="row">
	<div class="col-xs-4"></div>
	<div class="col-xs-4">
		@formSearch(form, routes.ClientController.index)
	</div>
	<div class="col-xs-4"></div>

	<div class="clearfix"></div>
	<div class="hr hr12 dotted"></div>
		
</div>

@if(response != null) {
<div class="row">
	<div class="col-xs-12">
		<div>
			<div id="user-profile-2" class="user-profile">
				<div class="tabbable">
					<ul class="nav nav-tabs padding-18">
						<li class="active">
							<a data-toggle="tab" href="#home">
								<i class="green ace-icon fa fa-user bigger-120"></i>
								Profile
							</a>
						</li>
						<!--
						<li>
							<a data-toggle="tab" href="#feed">
								<i class="orange ace-icon fa fa-rss bigger-120"></i>
								Query History
							</a>
						</li>
						-->
						<li>
							<a data-toggle="tab" href="#stats">
								<i class="blue ace-icon fa fa-star bigger-120"></i>
								Statistic
							</a>
						</li>

						

						<li>
							<a data-toggle="tab" href="#black-history">
								<i class="blue ace-icon fa fa-star bigger-120"></i>
								Black History
							</a>
						</li>

						<!--
						<li>
							<a data-toggle="tab" href="#pictures">
								<i class="pink ace-icon fa fa-picture-o bigger-120"></i>
								Pictures
							</a>
						</li>
						-->
					</ul>

					<div class="tab-content no-border padding-24">
						<div id="home" class="tab-pane in active">
							<div class="row">
								<div class="col-xs-12 col-sm-3 center">
									<span class="profile-picture">
										<img class="img-responsive" alt="Alex's Avatar" id="avatar2" src="assets/images/user.default.png" height="128" width="128" />
									</span>

									<div class="space space-4"></div>
									
									<a href="#" class="btn btn-sm btn-block btn-success">
										<i class="ace-icon fa fa-plus-circle bigger-120"></i>
										<span class="bigger-110">@response.current.client</span>
									</a>

									
									<div class="space space-4"></div>

									<!--
									<div class="row">
										<div class="progress pos-rel" style="height: 30px; width: 275px; margin:0 auto;">
												<div class="progress-bar progress-bar-success" style="width: 80%;">80%</div>

												<div class="progress-bar progress-bar-danger" style="width: 20%;">20%</div>
										</div>
										
									</div><!-- /.row -->

									
									
									<div class="clearfix">
										<div class="grid2">
											<span class="bigger-175 blue">@formatNumber(response.current.queries)</span>
											<br />
											Queries
										</div>
										<div class="grid2">
											<span class="bigger-175 blue">@response.current.malwares</span>
											<br />
											Malwares
										</div>
									</div>
									<div class="hr hr16 dotted"></div>
									<div class="clearfix">
										<div class="grid1">
											<div class="infobox infobox-green">
												<div class="infobox-icon">
													<i class="ace-icon fa fa-star"></i>
												</div>
												<div class="infobox-data">
													<span class="infobox-data-number">
													@{
														val value = response.current.rank
														if (value == 0) {
															"1M+"
														} else if (value > 999999) {
															<font size="4">1</font>
														} else {
															value
														}
													}
													</span>
													<div class="infobox-content">Rank</div>
												</div>
												@{
													val diff = response.current.rank - response.prev.rank
													if (diff >= 0) {
														<div class="stat stat-success">{diff}</div>
													} else {
														<div class="stat stat-important">{diff}</div>
													}
												}
											</div>
										</div>
									</div>
									
									<div class="clearfix">
										<div class="grid1">
											<div class="chart" id="binary-tree"></div>
										</div>
									</div>
									
								</div><!-- /.col -->

								<div class="col-xs-12 col-sm-9">
									<h4 class="blue">
										<span class="middle">Alex M. Doe</span>

										<span class="label label-purple arrowed-in-right">
											<i class="ace-icon fa fa-circle smaller-80 align-middle"></i>
											online
										</span>
									</h4>

									<div class="profile-user-info">
										<div class="profile-info-row">
											<div class="profile-info-name"> Username </div>

											<div class="profile-info-value">
												<span>alexdoe</span>
											</div>
										</div>

										<div class="profile-info-row">
											<div class="profile-info-name"> Location </div>

											<div class="profile-info-value">
												<i class="fa fa-map-marker light-orange bigger-110"></i>
												<span>Netherlands</span>
												<span>Amsterdam</span>
											</div>
										</div>

										<div class="profile-info-row">
											<div class="profile-info-name"> Age </div>

											<div class="profile-info-value">
												<span>38</span>
											</div>
										</div>

										<div class="profile-info-row">
											<div class="profile-info-name"> Joined </div>

											<div class="profile-info-value">
												<span>2010/06/20</span>
											</div>
										</div>

										<div class="profile-info-row">
											<div class="profile-info-name"> Last Online </div>

											<div class="profile-info-value">
												<span>3 hours ago</span>
											</div>
										</div>
									</div>

									<div class="hr hr-8 dotted"></div>

									<div class="profile-user-info">
										<div class="profile-info-row">
											<div class="profile-info-name"> Website </div>

											<div class="profile-info-value">
												<a href="#" target="_blank">www.alexdoe.com</a>
											</div>
										</div>

										<div class="profile-info-row">
											<div class="profile-info-name">
												<i class="middle ace-icon fa fa-facebook-square bigger-150 blue"></i>
											</div>

											<div class="profile-info-value">
												<a href="#">Find me on Facebook</a>
											</div>
										</div>

										<div class="profile-info-row">
											<div class="profile-info-name">
												<i class="middle ace-icon fa fa-twitter-square bigger-150 light-blue"></i>
											</div>

											<div class="profile-info-value">
												<a href="#">Follow me on Twitter</a>
											</div>
										</div>
									</div>

									<div class="hr hr-8 dotted"></div>

									<div class="row">
										<div class="col-sm-12">
											<div class="widget-box transparent">
												<div class="widget-header widget-header-small">
													<h4 class="widget-title blue smaller">
														<i class="ace-icon fa fa-bar-chart orange"></i>
														Hourly
													</h4>
													<div class="widget-toolbar">
														<a href="#" data-action="collapse"><i class="ace-icon fa fa-chevron-up"></i></a>
													</div>
												</div>
												<div class="widget-body" style="display: block;">
													<div class="widget-main no-padding">
														<div id="hourly-column-chart"></div>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div><!-- /.col -->
							</div><!-- /.row -->


							<div class="space-20"></div>
							
						</div><!-- /#home -->

						<div id="feed" class="tab-pane">
							<div id="timeline-2">
								<div class="row">
									<div class="col-xs-12 col-sm-10 col-sm-offset-1">
										<div class="timeline-container timeline-style2">
											<div id="load_more">
												@timeline(response.history)
											</div>
										</div>
									</div>
								</div>
							</div>
							
							<div class="space-12"></div>

							<div class="center">
								<button type="button" class="btn btn-sm btn-primary btn-white btn-round" id="loadMore">
									<i class="ace-icon fa fa-rss bigger-150 middle orange2"></i>
									<span class="bigger-110">View more activities</span>
									<i class="icon-on-right ace-icon fa fa-arrow-right"></i>
								</button>
							</div>
						</div><!-- /#feed -->

						<div id="stats" class="tab-pane">
							<div class="row">
								<div class="col-sm-4">
									<div class="widget-box transparent">
										<div class="widget-header widget-header-small">
											<h4 class="widget-title blue smaller">
												<i class="ace-icon fa fa-bar-chart orange"></i>
												Top 10 Main Domain
											</h4>
											<div class="widget-toolbar">
												<a href="#" data-action="collapse"><i class="ace-icon fa fa-chevron-up"></i></a>
											</div>
										</div>
										<div class="widget-body" style="display: block;">
											<div class="widget-main no-padding">
												<div id="top-10-second"></div>
											</div>
										</div>
									</div>
								</div>
								<div class="col-sm-4">
									<div class="widget-box transparent">
										<div class="widget-header widget-header-small">
											<h4 class="widget-title blue smaller">
												<i class="ace-icon fa fa-bar-chart orange"></i>
												Top 10 Domain
											</h4>
											<div class="widget-toolbar">
												<a href="#" data-action="collapse"><i class="ace-icon fa fa-chevron-up"></i></a>
											</div>
										</div>
										<div class="widget-body" style="display: block;">
											<div class="widget-main no-padding">
												<div id="top-10-domain"></div>
											</div>
										</div>
									</div>
								</div>
								
							</div><!-- /.row -->
							<div class="row">
								<div class="col-sm-12">
									<div class="widget-box transparent">
										<div class="widget-header widget-header-small">
											<h4 class="widget-title blue smaller">
												<i class="ace-icon fa fa-bar-chart orange"></i>
												Daily
											</h4>
											<div class="widget-toolbar">
												<a href="#" data-action="collapse"><i class="ace-icon fa fa-chevron-up"></i></a>
											</div>
										</div>
										<div class="widget-body" style="display: block;">
											<div class="widget-main no-padding">
												<div id="daily-line-chart"></div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div id="black-history" class="tab-pane">
							<div id="timeline-2">
								<div class="row">
									<div class="col-xs-12 col-sm-10 col-sm-offset-1">
										<div class="timeline-container timeline-style2">
											<div id="load_more2">
												<!-- Array[String]("Day", "Time", "Domain", "Second", "Malware", "RCode", "Answers") -->
												@topRankTable(
		            								Array[String]("Day", "Time", "Domain", "Second", "Malware", "RCode", "Answers"),
						              				response.historyBlack.asInstanceOf[Array[Array[Any]]],
						                			"history-black"
						            			)
											</div>
										</div>
									</div>
								</div>
							</div>
							
							<div class="space-12"></div>

							<div class="center">
								<button type="button" class="btn btn-sm btn-primary btn-white btn-round" id="loadMore2">
									<i class="ace-icon fa fa-rss bigger-150 middle orange2"></i>
									<span class="bigger-110">View more activities</span>
									<i class="icon-on-right ace-icon fa fa-arrow-right"></i>
								</button>
							</div>
						</div><!-- /#feed -->

					</div>
				</div>
			</div>					
		</div>
		<!-- PAGE CONTENT ENDS -->
	</div><!-- /.col -->
</div><!-- /.row -->
} else {
	<div class="row">
		<div class="alert alert-block alert-success">
			<button type="button" class="close" data-dismiss="alert">
				<i class="ace-icon fa fa-times"></i>
			</button>
			<i class="ace-icon fa fa-check green"></i>
			Top
			<strong class="green">
				100 
			</strong> Clients
		</div>
	</div>
	<div class="profile-feed row">
		<div class="col-sm-3">
			<div class="profile-activity clearfix">
				@for(i <- 0 until 25) {
				<div>
					<font size="4px" color="green">@(i + 1)</font>
					<a class="user" href="/client?q=@topClient(i)._1"> @topClient(i)._1 </a>
					<div class="time">
						<i class="ace-icon fa fa-clock-o bigger-110"></i>
						@formatNumber(topClient(i)._2)
					</div>
				</div>
				<div class="space space-4"></div>
				}
				

				<div class="tools action-buttons">
					<a href="#" class="blue">
						<i class="ace-icon fa fa-pencil bigger-125"></i>
					</a>

					<a href="#" class="red">
						<i class="ace-icon fa fa-times bigger-125"></i>
					</a>
				</div>
			</div>
		</div>
		<div class="col-sm-3">
			<div class="profile-activity clearfix">
				@for(i <- 25 until 50) {
				<div>
					<font size="4px" color="green">@(i + 1)</font>
					<a class="user" href="/client?q=@topClient(i)._1"> @topClient(i)._1 </a>
					<div class="time">
						<i class="ace-icon fa fa-clock-o bigger-110"></i>
						@formatNumber(topClient(i)._2)
					</div>
				</div>
				<div class="space space-4"></div>
				}
				

				<div class="tools action-buttons">
					<a href="#" class="blue">
						<i class="ace-icon fa fa-pencil bigger-125"></i>
					</a>

					<a href="#" class="red">
						<i class="ace-icon fa fa-times bigger-125"></i>
					</a>
				</div>
			</div>
		</div>
		<div class="col-sm-3">
			<div class="profile-activity clearfix">
				@for(i <- 50 until 75) {
				<div>
					<font size="4px" color="green">@(i + 1)</font>
					<a class="user" href="/client?q=@topClient(i)._1"> @topClient(i)._1 </a>
					<div class="time">
						<i class="ace-icon fa fa-clock-o bigger-110"></i>
						@formatNumber(topClient(i)._2)
					</div>
				</div>
				<div class="space space-4"></div>
				}
				

				<div class="tools action-buttons">
					<a href="#" class="blue">
						<i class="ace-icon fa fa-pencil bigger-125"></i>
					</a>

					<a href="#" class="red">
						<i class="ace-icon fa fa-times bigger-125"></i>
					</a>
				</div>
			</div>
		</div>
		<div class="col-sm-3">
			<div class="profile-activity clearfix">
				@for(i <- 75 until 100) {
				<div>
					<font size="4px" color="green">@(i + 1)</font>
					<a class="user" href="/client?q=@topClient(i)._1"> @topClient(i)._1 </a>
					<div class="time">
						<i class="ace-icon fa fa-clock-o bigger-110"></i>
						@formatNumber(topClient(i)._2)
					</div>
				</div>
				<div class="space space-4"></div>
				}
				

				<div class="tools action-buttons">
					<a href="#" class="blue">
						<i class="ace-icon fa fa-pencil bigger-125"></i>
					</a>

					<a href="#" class="red">
						<i class="ace-icon fa fa-times bigger-125"></i>
					</a>
				</div>
			</div>
		</div>
	</div><!-- /.row -->
}

@scripts = {
@if(response == null) {
		<script type="text/javascript"></script>
	} else {
<script type="text/javascript">
	$(function () {

		var categories = @Html(Json.stringify(Json.toJson(response.topDomain.map(x => getLinkTag(x.name)))));
	    var queries = @Html(Json.stringify(Json.toJson(response.topDomain.map(x => x.queries))));
	    

	    Highcharts.chart('top-10-domain', {
	        chart: {
	            type: 'bar',
	            height: '400px'
	        },
	        title: {
	            text: "Top 10 Domain"
	        },
	        plotOptions: {
	        bar: {
	            	dataLabels: {
	                	enabled: true
	            	}
	        	}
	    	},
	        xAxis: {
	            categories: categories
	        },

	        yAxis: {
	            title: {
	                text: "Queries"
	            }
	        },
	        series: [
	        {
	            name: "Queries",
	            data: queries
	        }]
	    });

	    categories = @Html(Json.stringify(Json.toJson(response.topSecond.map(x => getLinkTag(x.name)))));
	    queries = @Html(Json.stringify(Json.toJson(response.topSecond.map(x => x.queries))));
	    

	    Highcharts.chart('top-10-second', {
	        chart: {
	            type: 'bar',
	            height: '400px'
	        },
	        title: {
	            text: "Top 10 Main Domain"
	        },
	        plotOptions: {
	        bar: {
	            	dataLabels: {
	                	enabled: true
	            	}
	        	}
	    	},
	        xAxis: {
	            categories: categories
	        },

	        yAxis: {
	            title: {
	                text: "Queries"
	            }
	        },
	        series: [
	        {
	            name: "Queries",
	            data: queries
	        }]
	    });
	    
	    var hours = @Html(Json.stringify(Json.toJson(response.hourly.map(x => x._1))));
	    var values = @Html(Json.stringify(Json.toJson(response.hourly.map(x => x._2))));
	    Highcharts.chart('hourly-column-chart', {
		    chart: {
		        type: 'column',
		        height: '400px'
		    },
		    title: {
		        text: 'Hourly queries'
		    },
		    xAxis: {
		        categories: hours,
		        crosshair: true
		    },
		    yAxis: {
		        min: 0,
		        title: {
		            text: 'Num Of Queries'
		        }
		    },
		    plotOptions: {
		        column: {
		            pointPadding: 0.2,
		            borderWidth: 0
		        }
		    },
		    series: [{
		        name: 'Queries',
		        data: values

		    }]
		});
		
		var days = @Html(Json.stringify(Json.toJson(response.daily.map(x => x.day))));
	    values = @Html(Json.stringify(Json.toJson(response.daily.map(x => x.queries))));
	    domains = @Html(Json.stringify(Json.toJson(response.daily.map(x => x.domains))));
	    Highcharts.chart('daily-line-chart', {
		    chart: {
		        type: 'line',
		        height: '400px'
		    },
		    title: {
		        text: 'Hourly queries'
		    },
		    xAxis: {
		        categories: days,
		        crosshair: true
		    },
		    yAxis: {
		        min: 0,
		        title: {
		            text: 'Num Of Queries'
		        }
		    },
		    plotOptions: {
		        column: {
		            pointPadding: 0.2,
		            borderWidth: 0
		        },
		        line: {
	            	dataLabels: {
	                	enabled: true
	            	},
	                enableMouseTracking: false
	            }
		    },
		    series: [{
		        name: 'Queries',
		        type: 'spline',
		        data: values
		    },{
		        name: 'Domains',
		        type: 'spline',
		        data: domains
		    }]
		});
	    
	    /*
	    $("#loadMore").on('click', function (e) {
	    	
        	e.preventDefault();
        	/*
        	$("div:hidden").slice(0, 4).slideDown();
        	if ($("div:hidden").length == 0) {
            	$("#load").fadeOut('slow');
        	}
        	$('html,body').animate({
            	scrollTop: $(this).offset().top
        	}, 1500);
        	*
        	//val data = @@routes.ClientController.history
        	$('#load_more').append('');
        	
        	alert("---------------")
   		});
	    */
		
		
		var element = $('#load_more2');
  		var url     = "/history?ip=@ip&offset="
  		//var limit   = parseInt(element.data('limit'));
  		//var offset  = limit;
  		var offset = @services.domain.CommonService.SIZE_DEFAULT

	  	$('#loadMore2').on('click', function(e) {
	  		
	    	$.get(url + offset, function(data) {
	      		element.children().last().after(data);
	      		offset += @services.domain.CommonService.SIZE_DEFAULT;
	  		})
	  		
	  		//alert("Load More Clicked!")
	    });
	    
		
	  	
	  	var chart_config = {
	        chart: {
	            container: "#binary-tree",

	            animateOnInit: true,
	            
	            node: {
	                collapsable: true
	            },
	            animation: {
	                nodeAnimation: "easeOutBounce",
	                nodeSpeed: 700,
	                connectorsAnimation: "bounce",
	                connectorsSpeed: 700
	            }
	        },
	        /*
	        nodeStructure: {
	            image: "img/malory.png",
	            text: { name: "Parent node" },
	            children: [
	                {
	                    image: "img/lana.png",
	                    collapsed: true,
	                    children: [
	                        {
	                            image: "img/figgs.png"
	                        }
	                    ]
	                },
	                {
	                    image: "img/sterling.png",
	                    childrenDropLevel: 1,
	                    children: [
	                        {
	                            image: "img/woodhouse.png"
	                        }
	                    ]
	                },
	                {
	                    pseudo: true,
	                    children: [
	                        {
	                            image: "img/cheryl.png"
	                        },
	                        {
	                            image: "img/pam.png"
	                        }
	                    ]
	                }
	            ]
	        }
	        */
	        nodeStructure: {
	            text: { name: "Domain", value: "@formatNumber(response.current.domains)"},
	            collapsable: true,
	            children: [
	                {
	                    text: { name: "Valid", value: "@formatNumber(response.current.valid)"  },
	                    childrenDropLevel: 1,
	                    collapsable: true,
	                    children: [
	                        {
	                            text: { name: "Main", value: "@formatNumber(response.current.seconds)"  }
	                            /*
	                            children: [
	                            	{text: { name: "Black", value: "1,123,985"  }},
	                            	{text: { name: "White", value: "1,123,985"  }},
	                            	{text: { name: "Unknow", value: "1,123,985"  }}
	                            ]
	                            */
	                        }
	                    ]
	                },
	                {
	                    text: { name: "inValid", value: "@formatNumber(response.current.domains - response.current.valid)"  },
	                    collapsable: true
	                }
	            ]
	        }
	    };
	    tree = new Treant( chart_config );
	    
	});

	

</script>
}}

@bottom("..", "profile", scripts)
